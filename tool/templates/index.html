<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººæé–‹ç™ºæ”¯æ´åŠ©æˆé‡‘ æ›¸é¡ä½œæˆãƒ„ãƒ¼ãƒ«</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            background: #f0f4f8;
            color: #333;
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(135deg, #1a5276, #2980b9);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 { font-size: 1.5em; margin-bottom: 5px; }
        .header p { font-size: 0.9em; opacity: 0.9; }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin: 20px 0 30px;
            position: relative;
        }
        .progress-bar::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 5%;
            right: 5%;
            height: 3px;
            background: #ddd;
            z-index: 0;
        }
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1;
            cursor: pointer;
            flex: 1;
        }
        .progress-step .circle {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #ddd;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }
        .progress-step.active .circle {
            background: #2980b9;
            color: white;
        }
        .progress-step.completed .circle {
            background: #27ae60;
            color: white;
        }
        .progress-step .label {
            font-size: 11px;
            margin-top: 5px;
            text-align: center;
            color: #999;
        }
        .progress-step.active .label { color: #2980b9; font-weight: bold; }
        .progress-step.completed .label { color: #27ae60; }
        .step-panel {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            display: none;
        }
        .step-panel.active { display: block; }
        .step-panel h2 {
            font-size: 1.3em;
            color: #1a5276;
            margin-bottom: 5px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        .step-panel .desc {
            color: #666;
            font-size: 0.85em;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 18px;
        }
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #444;
        }
        .form-group label .required {
            color: #e74c3c;
            font-size: 0.8em;
            margin-left: 4px;
        }
        .form-group label .hint {
            color: #888;
            font-size: 0.8em;
            font-weight: normal;
            display: block;
            margin-top: 2px;
        }
        input[type="text"], input[type="number"], input[type="email"],
        select, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.3s;
            font-family: inherit;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #2980b9;
            outline: none;
        }
        textarea { resize: vertical; min-height: 100px; }
        .inline-group {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        .inline-group .form-group { flex: 1; }
        .inline-group .separator {
            padding: 10px 5px;
            font-size: 1.2em;
            color: #666;
        }
        .radio-group, .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .radio-option, .checkbox-option {
            flex: 1;
            min-width: 180px;
        }
        .radio-option label, .checkbox-option label {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: normal;
        }
        .radio-option input:checked + label,
        .checkbox-option input:checked + label {
            border-color: #2980b9;
            background: #eaf2f8;
        }
        .radio-option input, .checkbox-option input {
            display: none;
        }
        .radio-option label::before {
            content: 'â—‹';
            margin-right: 8px;
            color: #ccc;
            font-size: 1.2em;
        }
        .radio-option input:checked + label::before {
            content: 'â—';
            color: #2980b9;
        }
        .btn-row {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-family: inherit;
        }
        .btn-primary {
            background: #2980b9;
            color: white;
        }
        .btn-primary:hover { background: #2471a3; }
        .btn-secondary {
            background: #eee;
            color: #666;
        }
        .btn-secondary:hover { background: #ddd; }
        .btn-success {
            background: #27ae60;
            color: white;
            font-size: 1.1em;
            padding: 15px 40px;
        }
        .btn-success:hover { background: #229954; }
        .worker-entry {
            background: #f8f9fa;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .worker-entry h4 {
            color: #2980b9;
            margin-bottom: 10px;
        }
        .btn-add-worker {
            background: #eaf2f8;
            color: #2980b9;
            border: 2px dashed #2980b9;
            border-radius: 8px;
            padding: 12px;
            width: 100%;
            cursor: pointer;
            font-size: 14px;
            font-family: inherit;
        }
        .btn-add-worker:hover { background: #d4e6f1; }
        .btn-remove {
            background: #fde8e8;
            color: #e74c3c;
            border: none;
            border-radius: 4px;
            padding: 4px 10px;
            cursor: pointer;
            font-size: 12px;
            float: right;
        }
        .conditional { display: none; }
        .conditional.show { display: block; }
        .result-panel {
            text-align: center;
            padding: 40px 20px;
        }
        .result-panel .icon {
            font-size: 4em;
            margin-bottom: 15px;
        }
        .result-panel h2 { margin-bottom: 15px; }
        .file-list {
            text-align: left;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .file-list li {
            padding: 6px 0;
            list-style: none;
            border-bottom: 1px solid #eee;
        }
        .file-list li::before {
            content: 'ğŸ“„ ';
        }
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        .loading .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #ddd;
            border-top-color: #2980b9;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .section-divider {
            border: none;
            border-top: 2px solid #eef2f5;
            margin: 25px 0;
        }
        .info-box {
            background: #eaf2f8;
            border-left: 4px solid #2980b9;
            padding: 12px 15px;
            margin-bottom: 18px;
            border-radius: 0 8px 8px 0;
            font-size: 0.85em;
            color: #555;
        }
        @media (max-width: 600px) {
            .container { padding: 10px; }
            .step-panel { padding: 20px 15px; }
            .inline-group { flex-direction: column; }
            .progress-step .label { font-size: 9px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>äººæé–‹ç™ºæ”¯æ´åŠ©æˆé‡‘ æ›¸é¡ä½œæˆãƒ„ãƒ¼ãƒ«</h1>
        <p>äº‹æ¥­å±•é–‹ç­‰ãƒªã‚¹ã‚­ãƒªãƒ³ã‚°æ”¯æ´ã‚³ãƒ¼ã‚¹ - è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§å…¨æ›¸é¡ãŒå®Œæˆã—ã¾ã™</p>
    </div>

    <div class="container">
        <div class="progress-bar" id="progressBar">
            <div class="progress-step active" onclick="goToStep(0)">
                <div class="circle">1</div>
                <div class="label">åŸºæœ¬æƒ…å ±</div>
            </div>
            <div class="progress-step" onclick="goToStep(1)">
                <div class="circle">2</div>
                <div class="label">äº‹æ¥­æ‰€</div>
            </div>
            <div class="progress-step" onclick="goToStep(2)">
                <div class="circle">3</div>
                <div class="label">è¨“ç·´æ¦‚è¦</div>
            </div>
            <div class="progress-step" onclick="goToStep(3)">
                <div class="circle">4</div>
                <div class="label">äº‹æ¥­å±•é–‹</div>
            </div>
            <div class="progress-step" onclick="goToStep(4)">
                <div class="circle">5</div>
                <div class="label">è¨“ç·´è©³ç´°</div>
            </div>
            <div class="progress-step" onclick="goToStep(5)">
                <div class="circle">6</div>
                <div class="label">å¯¾è±¡åŠ´åƒè€…</div>
            </div>
            <div class="progress-step" onclick="goToStep(6)">
                <div class="circle">7</div>
                <div class="label">çµŒè²»æƒ…å ±</div>
            </div>
            <div class="progress-step" onclick="goToStep(7)">
                <div class="circle">8</div>
                <div class="label">ç¢ºèªãƒ»ç”Ÿæˆ</div>
            </div>
        </div>

        <!-- STEP 1: åŸºæœ¬æƒ…å ± -->
        <div class="step-panel active" id="step0">
            <h2>Step 1: åŸºæœ¬æƒ…å ±</h2>
            <p class="desc">ç”³è«‹ã™ã‚‹äº‹æ¥­ä¸»ï¼ˆä¼šç¤¾ï¼‰ã®åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

            <div class="info-box">
                ã“ã“ã§å…¥åŠ›ã™ã‚‹æƒ…å ±ã¯å…¨ã¦ã®æ›¸é¡ã«å…±é€šã§ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚æ­£ç¢ºã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
            </div>

            <div class="inline-group">
                <div class="form-group">
                    <label>æå‡ºæ—¥ï¼ˆå¹´ï¼‰<span class="required">*</span>
                        <span class="hint">è¥¿æš¦ã§å…¥åŠ›ï¼ˆä¾‹ï¼š2026ï¼‰</span></label>
                    <input type="number" id="submit_year" value="2026" min="2024" max="2030">
                </div>
                <div class="separator">/</div>
                <div class="form-group">
                    <label>æœˆ<span class="required">*</span></label>
                    <input type="number" id="submit_month" min="1" max="12">
                </div>
                <div class="separator">/</div>
                <div class="form-group">
                    <label>æ—¥<span class="required">*</span></label>
                    <input type="number" id="submit_day" min="1" max="31">
                </div>
            </div>

            <div class="form-group">
                <label>æå‡ºå…ˆã®åŠ´åƒå±€<span class="required">*</span>
                    <span class="hint">äº‹æ¥­æ‰€ã®æ‰€åœ¨åœ°ã‚’ç®¡è½„ã™ã‚‹åŠ´åƒå±€åï¼ˆä¾‹ï¼šæ±äº¬ï¼‰</span></label>
                <input type="text" id="labor_bureau" placeholder="ä¾‹ï¼šæ±äº¬">
            </div>

            <hr class="section-divider">

            <div class="inline-group">
                <div class="form-group">
                    <label>äº‹æ¥­ä¸» éƒµä¾¿ç•ªå·<span class="required">*</span></label>
                    <input type="text" id="postal_code_1" placeholder="100" maxlength="3">
                </div>
                <div class="separator">-</div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <input type="text" id="postal_code_2" placeholder="8916" maxlength="4">
                </div>
            </div>

            <div class="form-group">
                <label>äº‹æ¥­ä¸» æ‰€åœ¨åœ°<span class="required">*</span>
                    <span class="hint">éƒ½é“åºœçœŒã‹ã‚‰ç•ªåœ°ã¾ã§æ­£ç¢ºã«å…¥åŠ›</span></label>
                <input type="text" id="company_address" placeholder="ä¾‹ï¼šæ±äº¬éƒ½åƒä»£ç”°åŒºéœãŒé–¢ï¼‘âˆ’ï¼âˆ’ï¼">
            </div>

            <div class="form-group">
                <label>ç”³è«‹è€…ã®ç¨®åˆ¥<span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="applicant_type" id="applicant_corp" value="corporate" checked>
                        <label for="applicant_corp">æ³•äººï¼ˆæ ªå¼ä¼šç¤¾ãƒ»åˆåŒä¼šç¤¾ç­‰ï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="applicant_type" id="applicant_individual" value="individual">
                        <label for="applicant_individual">å€‹äººäº‹æ¥­ä¸»</label>
                    </div>
                </div>
            </div>

            <div class="form-group" id="company_name_group">
                <label><span id="company_name_label">äº‹æ¥­ä¸» åç§°ï¼ˆä¼šç¤¾åï¼‰</span><span class="required">*</span></label>
                <input type="text" id="company_name" placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹">
            </div>

            <div class="inline-group" id="representative_group">
                <div class="form-group">
                    <label id="rep_title_label">ä»£è¡¨è€… å½¹è·å</label>
                    <input type="text" id="representative_title" placeholder="ä¾‹ï¼šä»£è¡¨å–ç· å½¹">
                </div>
                <div class="form-group">
                    <label>ä»£è¡¨è€… æ°å<span class="required">*</span></label>
                    <input type="text" id="representative_name" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ">
                </div>
            </div>

            <div class="form-group conditional show" id="corporate_number_group">
                <label>æ³•äººç•ªå·ï¼ˆ13æ¡ï¼‰
                    <span class="hint">æ³•äººã®å ´åˆã®ã¿ã€‚å›½ç¨åºã®æ³•äººç•ªå·å…¬è¡¨ã‚µã‚¤ãƒˆã§ç¢ºèªã§ãã¾ã™</span></label>
                <input type="text" id="corporate_number" placeholder="1234567890123" maxlength="13">
            </div>

            <hr class="section-divider">

            <div class="form-group">
                <label>ç¤¾ä¼šä¿é™ºåŠ´å‹™å£«ãƒ»ä»£ç†äººã«ä¾é ¼ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="has_agent" id="has_agent_no" value="no" checked>
                        <label for="has_agent_no">ã„ã„ãˆï¼ˆè‡ªç¤¾ã§æå‡ºï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="has_agent" id="has_agent_yes" value="yes">
                        <label for="has_agent_yes">ã¯ã„</label>
                    </div>
                </div>
            </div>

            <div class="conditional" id="agent_section">
                <div class="info-box">ä»£ç†äººãƒ»ç¤¾ä¼šä¿é™ºåŠ´å‹™å£«ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                <div class="form-group">
                    <label>æå‡ºã®ç¨®é¡</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="agent_type" id="agent_type_1" value="ä»£è¡Œ" checked>
                            <label for="agent_type_1">æå‡ºä»£è¡Œè€…</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="agent_type" id="agent_type_2" value="ä»£ç†">
                            <label for="agent_type_2">äº‹å‹™ä»£ç†è€…</label>
                        </div>
                    </div>
                </div>
                <div class="inline-group">
                    <div class="form-group">
                        <label>éƒµä¾¿ç•ªå·</label>
                        <input type="text" id="agent_postal_1" maxlength="3">
                    </div>
                    <div class="separator">-</div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <input type="text" id="agent_postal_2" maxlength="4">
                    </div>
                </div>
                <div class="form-group">
                    <label>æ‰€åœ¨åœ°</label>
                    <input type="text" id="agent_address">
                </div>
                <div class="form-group">
                    <label>åç§°ï¼ˆäº‹å‹™æ‰€åï¼‰</label>
                    <input type="text" id="agent_name_org">
                </div>
                <div class="form-group">
                    <label>æ°å</label>
                    <input type="text" id="agent_name_person">
                </div>
                <div class="inline-group">
                    <div class="form-group">
                        <label>é›»è©±ç•ªå·</label>
                        <input type="text" id="agent_phone_1" placeholder="03" maxlength="4">
                    </div>
                    <div class="separator">-</div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <input type="text" id="agent_phone_2" maxlength="4">
                    </div>
                    <div class="separator">-</div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <input type="text" id="agent_phone_3" maxlength="4">
                    </div>
                </div>
            </div>

            <div class="btn-row">
                <div></div>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 2: äº‹æ¥­æ‰€æƒ…å ± -->
        <div class="step-panel" id="step1">
            <h2>Step 2: é›‡ç”¨ä¿é™ºé©ç”¨äº‹æ¥­æ‰€ã®æƒ…å ±</h2>
            <p class="desc">è¨“ç·´ã‚’å®Ÿæ–½ã™ã‚‹äº‹æ¥­æ‰€ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

            <div class="form-group">
                <label>é›‡ç”¨ä¿é™ºé©ç”¨äº‹æ¥­æ‰€ã®åç§°<span class="required">*</span>
                    <span class="hint">æœ¬ç¤¾åã¨ç•°ãªã‚‹å ´åˆã¯äº‹æ¥­æ‰€åã‚’å…¥åŠ›</span></label>
                <input type="text" id="office_name" placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹ æœ¬ç¤¾">
            </div>

            <div class="inline-group">
                <div class="form-group">
                    <label>é›‡ç”¨ä¿é™ºé©ç”¨äº‹æ¥­æ‰€ç•ªå·<span class="required">*</span>
                        <span class="hint">4æ¡-6æ¡-1æ¡</span></label>
                    <input type="text" id="office_number_1" placeholder="1301" maxlength="4">
                </div>
                <div class="separator">-</div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <input type="text" id="office_number_2" placeholder="000000" maxlength="6">
                </div>
                <div class="separator">-</div>
                <div class="form-group" style="max-width:80px">
                    <label>&nbsp;</label>
                    <input type="text" id="office_number_3" placeholder="0" maxlength="1">
                </div>
            </div>

            <div class="inline-group">
                <div class="form-group">
                    <label>äº‹æ¥­æ‰€ éƒµä¾¿ç•ªå·</label>
                    <input type="text" id="office_postal_1" maxlength="3">
                </div>
                <div class="separator">-</div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <input type="text" id="office_postal_2" maxlength="4">
                </div>
            </div>

            <div class="form-group">
                <label>äº‹æ¥­æ‰€ æ‰€åœ¨åœ°<span class="required">*</span></label>
                <input type="text" id="office_address">
            </div>

            <hr class="section-divider">

            <div class="inline-group">
                <div class="form-group">
                    <label>æ‹…å½“è€… æ°å<span class="required">*</span></label>
                    <input type="text" id="contact_name" placeholder="ä¾‹ï¼šç”°ä¸­ èŠ±å­">
                </div>
                <div class="form-group">
                    <label>æ‹…å½“è€… æ‰€å±ãƒ»å½¹è·</label>
                    <input type="text" id="contact_dept" placeholder="ä¾‹ï¼šç·å‹™éƒ¨ ç·å‹™èª²é•·">
                </div>
            </div>

            <div class="inline-group">
                <div class="form-group">
                    <label>æ‹…å½“è€… é›»è©±ç•ªå·<span class="required">*</span></label>
                    <input type="text" id="contact_phone_1" maxlength="4">
                </div>
                <div class="separator">-</div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <input type="text" id="contact_phone_2" maxlength="4">
                </div>
                <div class="separator">-</div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <input type="text" id="contact_phone_3" maxlength="4">
                </div>
            </div>

            <div class="form-group">
                <label>æ‹…å½“è€… ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                <input type="email" id="contact_email" placeholder="example@company.co.jp">
            </div>

            <hr class="section-divider">

            <div class="form-group">
                <label>ä¼æ¥­å…¨ä½“ã§å¸¸æ™‚é›‡ç”¨ã™ã‚‹åŠ´åƒè€…æ•°<span class="required">*</span>
                    <span class="hint">ä¸­å°ä¼æ¥­ã®åˆ¤å®šã«ä½¿ç”¨ã•ã‚Œã¾ã™</span></label>
                <input type="number" id="total_employees" placeholder="ä¾‹ï¼š50">
            </div>

            <div class="form-group">
                <label>ä¸­å°ä¼æ¥­äº‹æ¥­ä¸»ã«è©²å½“ã—ã¾ã™ã‹ï¼Ÿ<span class="required">*</span>
                    <span class="hint">æ¥­ç¨®ã«ã‚ˆã‚ŠåŸºæº–ãŒç•°ãªã‚Šã¾ã™ã€‚ä¸æ˜ãªå ´åˆã¯åŠ´åƒå±€ã«ã”ç¢ºèªãã ã•ã„</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="is_sme" id="is_sme_yes" value="yes" checked>
                        <label for="is_sme_yes">ã¯ã„ï¼ˆä¸­å°ä¼æ¥­ï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="is_sme" id="is_sme_no" value="no">
                        <label for="is_sme_no">ã„ã„ãˆï¼ˆå¤§ä¼æ¥­ï¼‰</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>ä¸»ãŸã‚‹äº‹æ¥­<span class="required">*</span>
                    <span class="hint">æ—¥æœ¬æ¨™æº–ç”£æ¥­åˆ†é¡ã®å¤§åˆ†é¡ï¼ˆä¾‹ï¼šæƒ…å ±é€šä¿¡æ¥­ã€è£½é€ æ¥­ã€ã‚µãƒ¼ãƒ“ã‚¹æ¥­ï¼‰</span></label>
                <input type="text" id="main_business" placeholder="ä¾‹ï¼šæƒ…å ±é€šä¿¡æ¥­">
            </div>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 3: è¨“ç·´æ¦‚è¦ -->
        <div class="step-panel" id="step2">
            <h2>Step 3: è¨“ç·´ã®æ¦‚è¦</h2>
            <p class="desc">å®Ÿæ–½ã™ã‚‹è¨“ç·´ã®åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

            <div class="form-group">
                <label>åŠ©æˆåŒºåˆ†<span class="required">*</span>
                    <span class="hint">è¨“ç·´ã®ç›®çš„ã«åˆã‚ã›ã¦é¸æŠã—ã¦ãã ã•ã„</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="subsidy_type" id="subsidy_1" value="1">
                        <label for="subsidy_1">äº‹æ¥­å±•é–‹ã«ä¼´ã„å®Ÿæ–½ã™ã‚‹è¨“ç·´</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="subsidy_type" id="subsidy_2" value="2" checked>
                        <label for="subsidy_2">DXåŒ–ã«ä¼´ã„å®Ÿæ–½ã™ã‚‹è¨“ç·´</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="subsidy_type" id="subsidy_3" value="3">
                        <label for="subsidy_3">ã‚°ãƒªãƒ¼ãƒ³ãƒ»ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«åŒ–ã«ä¼´ã„å®Ÿæ–½ã™ã‚‹è¨“ç·´</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>å®šé¡åˆ¶ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å‹ï¼‰ã«ã‚ˆã‚‹è¨“ç·´ã§ã™ã‹ï¼Ÿ<span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="is_subscription" id="sub_no" value="no" checked>
                        <label for="sub_no">ã„ã„ãˆï¼ˆé€šå¸¸ã®è¨“ç·´ï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="is_subscription" id="sub_yes" value="yes">
                        <label for="sub_yes">ã¯ã„ï¼ˆå®šé¡åˆ¶ã‚µãƒ¼ãƒ“ã‚¹ï¼‰</label>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>è¨“ç·´ã‚³ãƒ¼ã‚¹ã®åç§°<span class="required">*</span>
                    <span class="hint">å—è¬›ã™ã‚‹è¨“ç·´ã®æ­£å¼åç§°</span></label>
                <input type="text" id="course_name" value="AIäººæè‚²æˆãƒ—ãƒ©ãƒ³" placeholder="ä¾‹ï¼šãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆè‚²æˆã‚³ãƒ¼ã‚¹">
            </div>

            <div class="form-group">
                <label>å—è¬›ï¼ˆäºˆå®šï¼‰è€…æ•°<span class="required">*</span></label>
                <input type="number" id="num_trainees" placeholder="ä¾‹ï¼š5" min="1">
            </div>

            <div class="info-box">è¨“ç·´ã®å®Ÿæ–½æœŸé–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆé–‹å§‹æ—¥ã€œçµ‚äº†æ—¥ï¼‰</div>
            <div class="inline-group">
                <div class="form-group">
                    <label>é–‹å§‹æ—¥ï¼ˆå¹´ï¼‰</label>
                    <input type="number" id="training_start_year" min="2024" max="2030">
                </div>
                <div class="form-group">
                    <label>æœˆ</label>
                    <input type="number" id="training_start_month" min="1" max="12">
                </div>
                <div class="form-group">
                    <label>æ—¥</label>
                    <input type="number" id="training_start_day" min="1" max="31">
                </div>
                <div class="separator">ã€œ</div>
                <div class="form-group">
                    <label>çµ‚äº†æ—¥ï¼ˆå¹´ï¼‰</label>
                    <input type="number" id="training_end_year" min="2024" max="2030">
                </div>
                <div class="form-group">
                    <label>æœˆ</label>
                    <input type="number" id="training_end_month" min="1" max="12">
                </div>
                <div class="form-group">
                    <label>æ—¥</label>
                    <input type="number" id="training_end_day" min="1" max="31">
                </div>
            </div>

            <div class="conditional" id="subscription_section">
                <hr class="section-divider">
                <div class="info-box">å®šé¡åˆ¶ã‚µãƒ¼ãƒ“ã‚¹ã®å¥‘ç´„æœŸé–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                <div class="inline-group">
                    <div class="form-group">
                        <label>å¥‘ç´„é–‹å§‹æ—¥ï¼ˆå¹´ï¼‰</label>
                        <input type="number" id="contract_start_year">
                    </div>
                    <div class="form-group">
                        <label>æœˆ</label>
                        <input type="number" id="contract_start_month">
                    </div>
                    <div class="form-group">
                        <label>æ—¥</label>
                        <input type="number" id="contract_start_day">
                    </div>
                    <div class="separator">ã€œ</div>
                    <div class="form-group">
                        <label>å¥‘ç´„çµ‚äº†æ—¥ï¼ˆå¹´ï¼‰</label>
                        <input type="number" id="contract_end_year">
                    </div>
                    <div class="form-group">
                        <label>æœˆ</label>
                        <input type="number" id="contract_end_month">
                    </div>
                    <div class="form-group">
                        <label>æ—¥</label>
                        <input type="number" id="contract_end_day">
                    </div>
                </div>
                <div class="form-group">
                    <label>å¥‘ç´„ã¯è‡ªå‹•æ›´æ–°ã§ã™ã‹ï¼Ÿ</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="auto_renewal" id="renewal_no" value="no" checked>
                            <label for="renewal_no">ã„ã„ãˆ</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="auto_renewal" id="renewal_yes" value="yes">
                            <label for="renewal_yes">ã¯ã„</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>å¥‘ç´„è€…æ•°ï¼ˆç·å—è¬›è€…æ•°ï¼‰</label>
                    <input type="number" id="total_subscribers">
                </div>
            </div>

            <hr class="section-divider">

            <div class="form-group">
                <label>è¨“ç·´ã®å®Ÿæ–½æ–¹æ³•<span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="training_method" id="method_1" value="1">
                        <label for="method_1">é€šå­¦åˆ¶</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="training_method" id="method_2" value="2" checked>
                        <label for="method_2">åŒæ™‚åŒæ–¹å‘å‹ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="training_method" id="method_3" value="3">
                        <label for="method_3">eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="training_method" id="method_4" value="4">
                        <label for="method_4">é€šä¿¡åˆ¶</label>
                    </div>
                </div>
            </div>

            <div class="conditional" id="hours_classroom">
                <div class="inline-group">
                    <div class="form-group">
                        <label>ç·è¨“ç·´æ™‚é–“æ•°<span class="required">*</span></label>
                        <input type="number" id="total_hours" value="10" placeholder="ä¾‹ï¼š150">
                    </div>
                    <div class="form-group" style="max-width: 100px">
                        <label>åˆ†</label>
                        <input type="number" id="total_minutes" value="0" max="59">
                    </div>
                </div>
                <div class="inline-group">
                    <div class="form-group">
                        <label>OFF-JTå®Ÿè¨“ç·´æ™‚é–“æ•°<span class="required">*</span>
                            <span class="hint">ç·è¨“ç·´æ™‚é–“æ•°ã‹ã‚‰ä¼‘æ†©ãƒ»ç§»å‹•ç­‰ã‚’é™¤ã„ãŸæ™‚é–“</span></label>
                        <input type="number" id="offjt_hours" value="10" placeholder="ä¾‹ï¼š150">
                    </div>
                    <div class="form-group" style="max-width: 100px">
                        <label>åˆ†</label>
                        <input type="number" id="offjt_minutes" value="0" max="59">
                    </div>
                </div>
            </div>

            <div class="conditional" id="hours_elearning">
                <div class="inline-group">
                    <div class="form-group">
                        <label>æ¨™æº–å­¦ç¿’æ™‚é–“<span class="required">*</span></label>
                        <input type="number" id="standard_hours" placeholder="ä¾‹ï¼š100">
                    </div>
                    <div class="form-group" style="max-width: 100px">
                        <label>åˆ†</label>
                        <input type="number" id="standard_minutes" value="0" max="59">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>è³‡æ ¼è©¦é¨“ã‚’å—é¨“ã—ã¾ã™ã‹ï¼Ÿ</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="has_exam" id="exam_no" value="no" checked>
                        <label for="exam_no">ã„ã„ãˆ</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="has_exam" id="exam_yes" value="yes">
                        <label for="exam_yes">ã¯ã„</label>
                    </div>
                </div>
            </div>

            <div class="conditional" id="exam_section">
                <div class="form-group">
                    <label>è³‡æ ¼è©¦é¨“å</label>
                    <input type="text" id="exam_name">
                </div>
                <div class="inline-group">
                    <div class="form-group">
                        <label>å—é¨“æ—¥ï¼ˆå¹´ï¼‰</label>
                        <input type="number" id="exam_year">
                    </div>
                    <div class="form-group">
                        <label>æœˆ</label>
                        <input type="number" id="exam_month">
                    </div>
                    <div class="form-group">
                        <label>æ—¥</label>
                        <input type="number" id="exam_day">
                    </div>
                </div>
            </div>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 4: äº‹æ¥­å±•é–‹è¨ˆç”» -->
        <div class="step-panel" id="step3">
            <h2>Step 4: äº‹æ¥­å±•é–‹ç­‰å®Ÿæ–½è¨ˆç”»</h2>
            <p class="desc">äº‹æ¥­å±•é–‹ã®å†…å®¹ã‚’å…·ä½“çš„ã«è¨˜è¿°ã—ã¦ãã ã•ã„ï¼ˆæ§˜å¼ç¬¬1-3å·ã«ä½¿ç”¨ï¼‰</p>

            <div class="conditional show" id="expansion_section">
                <div class="form-group">
                    <label>äº‹æ¥­å±•é–‹ã®å®Ÿæ–½ï¼ˆäºˆå®šï¼‰æ™‚æœŸ<span class="required">*</span></label>
                    <div class="inline-group">
                        <div class="form-group">
                            <input type="number" id="expansion_year" placeholder="2026">
                        </div>
                        <div class="separator">å¹´</div>
                        <div class="form-group">
                            <input type="number" id="expansion_month" placeholder="10" min="1" max="12">
                        </div>
                        <div class="separator">æœˆï¼ˆäºˆå®šï¼‰</div>
                    </div>
                </div>

                <div class="form-group" id="expansion_content_group" style="display:none">
                    <label>äº‹æ¥­å±•é–‹ã®å†…å®¹<span class="required">*</span>
                        <span class="hint">ç¾åœ¨ã®äº‹æ¥­å†…å®¹ã¨ã€è¨“ç·´ã‚’è¡Œã†ç«¯ç·’ã¨ãªã‚‹äº‹æ¥­å±•é–‹ã®å†…å®¹ã‚’å…·ä½“çš„ã«è¨˜è¼‰ã—ã¦ãã ã•ã„</span></label>
                    <textarea id="expansion_content" rows="8" placeholder="ä¾‹ï¼šç¾åœ¨ã¯â—‹â—‹éƒ¨å“ã‚’ä¸­å¿ƒã¨ã™ã‚‹è£½é€ æ¥­ã‚’å–¶ã‚“ã§ã„ã‚‹ãŒã€ä»Šå¾Œã®åŠå°ä½“ã®éœ€è¦å¢—ã‚’è¦‹æ®ãˆã€åŠå°ä½“å·¥å ´ã®å»ºè¨­ã‚’äºˆå®šã—ã¦ãŠã‚Šã€å·¥å ´ã®è¨­å‚™ã‚„ç”Ÿç”£ãƒ©ã‚¤ãƒ³ã®å®‰å®šã—ãŸé‹ç”¨ã‚’å›³ã‚‹ãŸã‚ã€å„ç¨®è‡ªå‹•åˆ¶å¾¡æŠ€è¡“ã€é›»æ°—ä¿å…¨æŠ€è¡“ã€ç©ºåœ§è£…ç½®åˆ¶å¾¡æŠ€è¡“ç­‰ã‚’ç¿’å¾—ã™ã‚‹è¨“ç·´ã‚’å¾“æ¥­å“¡ã«å—è¬›ã•ã›ãŸã„ã€‚"></textarea>
                </div>

                <div class="form-group" id="dx_content_group">
                    <label>DXåŒ–åˆã¯ã‚°ãƒªãƒ¼ãƒ³ãƒ»ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«åŒ–ã®å†…å®¹<span class="required">*</span>
                        <span class="hint">è¨“ç·´ã‚’è¡Œã†ç«¯ç·’ã¨ãªã‚‹DXåŒ–ç­‰ã®å†…å®¹ã‚’å…·ä½“çš„ã«è¨˜è¼‰ã—ã¦ãã ã•ã„</span></label>
                    <textarea id="dx_content" rows="8" placeholder="ä¾‹ï¼šå»ºè¨­æ¥­ã«ãŠã„ã¦ã€DXåŒ–ã«ã‚ˆã‚‹æ¸¬é‡å—æ³¨ã®æ‹¡å¤§ã‚’å—ã‘ã¦ã€ãƒ‰ãƒ­ãƒ¼ãƒ³ã‚„BIMã‚’æ´»ç”¨ã—ãŸæ¸¬é‡ä½œæ¥­ã«ç¿’ç†Ÿã—ãŸå¾“æ¥­å“¡ã®è‚²æˆã‚’ç›®æŒ‡ã—ã€ãƒ‰ãƒ­ãƒ¼ãƒ³ã®æ“ç¸¦æŠ€èƒ½ã‚„BIMã®è¬›ç¿’ã‚’å—è¬›ã•ã›ãŸã„ã€‚">æ¥­å‹™ã®DXåŒ–æ¨é€²ã®ãŸã‚ã€ç”ŸæˆAIï¼ˆChatGPTç­‰ï¼‰ã‚’æ´»ç”¨ã—ãŸæ¥­å‹™åŠ¹ç‡åŒ–ãƒ»è‡ªå‹•åŒ–ã‚’å›³ã‚‹å¿…è¦ãŒã‚ã‚Šã€å¾“æ¥­å“¡ã«AIãƒ„ãƒ¼ãƒ«ã®é¸å®šãƒ»å°å…¥æ–¹æ³•ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã€æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã¸ã®AIçµ„ã¿è¾¼ã¿æ‰‹æ³•ç­‰ã‚’ç¿’å¾—ã•ã›ã‚‹ãŸã‚ã€å¤–éƒ¨ã®AIäººæè‚²æˆç ”ä¿®ã‚’å—è¬›ã•ã›ãŸã„ã€‚</textarea>
                </div>
            </div>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 5: è¨“ç·´è©³ç´° -->
        <div class="step-panel" id="step4">
            <h2>Step 5: è¨“ç·´ã®è©³ç´°</h2>
            <p class="desc">è¨“ç·´ã®å®Ÿæ–½å½¢æ…‹ã¨æ•™è‚²è¨“ç·´æ©Ÿé–¢ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

            <div class="form-group">
                <label>è¨“ç·´ã®å®Ÿæ–½å ´æ‰€<span class="required">*</span></label>
                <input type="text" id="training_location" value="ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆZoomç­‰ã‚’ä½¿ç”¨ã—ãŸåŒæ™‚åŒæ–¹å‘å‹é€šä¿¡è¨“ç·´ï¼‰é€ä¿¡å…ƒï¼šç§‹ç”°çœŒç§‹ç”°å¸‚æ‰‹å½¢å­—è¥¿è°·åœ°177-2" placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹ æ±äº¬éƒ½æ¸‹è°·åŒºâ—‹â—‹ / ã‚ªãƒ³ãƒ©ã‚¤ãƒ³">
            </div>

            <div class="form-group">
                <label>OFF-JTè¨“ç·´ã®ç¨®åˆ¥<span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="offjt_type" id="offjt_1" value="1">
                        <label for="offjt_1">äº‹æ¥­å†…è¨“ç·´ï¼ˆéƒ¨å†…è¬›å¸«ï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="offjt_type" id="offjt_2" value="2">
                        <label for="offjt_2">äº‹æ¥­å†…è¨“ç·´ï¼ˆéƒ¨å¤–è¬›å¸«ï¼‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="offjt_type" id="offjt_3" value="3" checked>
                        <label for="offjt_3">äº‹æ¥­å¤–è¨“ç·´</label>
                    </div>
                </div>
            </div>

            <div class="conditional" id="internal_instructor">
                <div class="form-group">
                    <label>è¬›å¸«ã®æ°å</label>
                    <input type="text" id="instructor_name">
                </div>
                <div class="form-group">
                    <label>è¬›å¸«ã®æ‰€å±éƒ¨ç½²</label>
                    <input type="text" id="instructor_dept">
                </div>
                <div class="form-group">
                    <label>è¬›å¸«ã®å½¹è·</label>
                    <input type="text" id="instructor_title">
                </div>
                <div class="form-group">
                    <label>è¬›å¸«ã®ä¸»ãªæ¥­å‹™</label>
                    <input type="text" id="instructor_duties">
                </div>
            </div>

            <div class="conditional show" id="external_training">
                <hr class="section-divider">
                <div class="info-box">æ•™è‚²è¨“ç·´æ©Ÿé–¢ï¼ˆã‚¹ã‚¯ãƒ¼ãƒ«ãƒ»ç ”ä¿®ä¼šç¤¾ç­‰ï¼‰ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
                <div class="form-group">
                    <label>æ•™è‚²è¨“ç·´æ©Ÿé–¢ã®åç§°<span class="required">*</span></label>
                    <input type="text" id="training_org_name" value="if(å¡¾)" placeholder="ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹ã‚¹ã‚¯ãƒ¼ãƒ«">
                </div>
                <div class="form-group">
                    <label>æ•™è‚²è¨“ç·´æ©Ÿé–¢ã®ä»£è¡¨è€…å</label>
                    <input type="text" id="training_org_rep" value="é«˜å´ç¿”å¤ª">
                </div>
                <div class="form-group">
                    <label>æ•™è‚²è¨“ç·´æ©Ÿé–¢ã®æ‰€åœ¨åœ°</label>
                    <input type="text" id="training_org_address" value="ç§‹ç”°çœŒç§‹ç”°å¸‚æ‰‹å½¢å­—è¥¿è°·åœ°177-2">
                </div>
                <div class="form-group">
                    <label>æ•™è‚²è¨“ç·´æ©Ÿé–¢ã®æ³•äººç•ªå·ï¼ˆæ”¯çµ¦ç”³è«‹æ‰¿è«¾æ›¸ç”¨ï¼‰</label>
                    <input type="text" id="training_org_corp_number" maxlength="13">
                </div>
                <div class="form-group">
                    <label>è¨“ç·´å¥‘ç´„ã‚’ç· çµã—ãŸçµŒç·¯</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" name="contract_reason" id="reason_1" value="1">
                            <label for="reason_1">è¨“ç·´å®Ÿæ–½ã«é–¢ã™ã‚‹å–¶æ¥­ã‚’å—ã‘ãŸ</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="contract_reason" id="reason_2" value="2" checked>
                            <label for="reason_2">è‡ªã‚‰æ¤œç´¢ã—ã¦è¦‹ã¤ã‘ãŸ</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" name="contract_reason" id="reason_3" value="3">
                            <label for="reason_3">ãã®ä»–</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 6: å¯¾è±¡åŠ´åƒè€… -->
        <div class="step-panel" id="step5">
            <h2>Step 6: å¯¾è±¡åŠ´åƒè€…ã®æƒ…å ±</h2>
            <p class="desc">è¨“ç·´ã‚’å—è¬›ã™ã‚‹åŠ´åƒè€…ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

            <div class="info-box">
                é›‡ç”¨ä¿é™ºè¢«ä¿é™ºè€…ç•ªå·ã¯ã€Œè³‡æ ¼å–å¾—ç­‰ç¢ºèªé€šçŸ¥æ›¸ã€ç­‰ã§ã”ç¢ºèªãã ã•ã„ã€‚ï¼ˆ4æ¡-6æ¡-1æ¡ã®å½¢å¼ï¼‰
            </div>

            <div id="workers_container">
                <div class="worker-entry" data-index="1">
                    <h4>å—è¬›è€… 1</h4>
                    <div class="inline-group">
                        <div class="form-group">
                            <label>æ°å<span class="required">*</span></label>
                            <input type="text" id="worker_1_name" placeholder="ä¾‹ï¼šä½è—¤ ä¸€éƒ">
                        </div>
                        <div class="form-group">
                            <label>ãƒ•ãƒªã‚¬ãƒŠ</label>
                            <input type="text" id="worker_1_name_kana" placeholder="ä¾‹ï¼šã‚µãƒˆã‚¦ ã‚¤ãƒãƒ­ã‚¦">
                        </div>
                    </div>
                    <div class="inline-group">
                        <div class="form-group">
                            <label>é›‡ç”¨ä¿é™ºè¢«ä¿é™ºè€…ç•ªå·</label>
                            <input type="text" id="worker_1_insurance_1" placeholder="1234" maxlength="4">
                        </div>
                        <div class="separator">-</div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <input type="text" id="worker_1_insurance_2" placeholder="567890" maxlength="6">
                        </div>
                        <div class="separator">-</div>
                        <div class="form-group" style="max-width:80px">
                            <label>&nbsp;</label>
                            <input type="text" id="worker_1_insurance_3" placeholder="1" maxlength="1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>é›‡ç”¨å½¢æ…‹</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" name="worker_1_type" id="worker_1_regular" value="regular" checked>
                                <label for="worker_1_regular">æ­£è¦é›‡ç”¨åŠ´åƒè€…ç­‰</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" name="worker_1_type" id="worker_1_contract" value="contract">
                                <label for="worker_1_contract">æœ‰æœŸå¥‘ç´„åŠ´åƒè€…ç­‰</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="btn-add-worker" onclick="addWorker()">+ å—è¬›è€…ã‚’è¿½åŠ </button>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 7: çµŒè²»æƒ…å ± -->
        <div class="step-panel" id="step6">
            <h2>Step 7: è¨“ç·´çµŒè²»ã®æƒ…å ±</h2>
            <p class="desc">è¨“ç·´ã«ã‹ã‹ã‚‹çµŒè²»ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆæ”¯çµ¦ç”³è«‹æ™‚ã«ä½¿ç”¨ï¼‰</p>

            <div class="info-box">
                æ”¯çµ¦ç”³è«‹æ™‚ã«å¿…è¦ãªæƒ…å ±ã§ã™ã€‚ã¾ã ç¢ºå®šã—ã¦ã„ãªã„å ´åˆã¯æ¦‚ç®—ã§å…¥åŠ›ã—ã€å¾Œã§ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚
            </div>

            <div class="form-group">
                <label>è¨ˆç”»å±Šã®å—ä»˜ç•ªå·
                    <span class="hint">è¨ˆç”»å±Šæå‡ºå¾Œã«åŠ´åƒå±€ã‹ã‚‰ä»˜ä¸ã•ã‚Œã‚‹ç•ªå·ã€‚ã¾ã æœªå–å¾—ã®å ´åˆã¯ç©ºæ¬„ã§OK</span></label>
                <input type="text" id="plan_receipt_number" placeholder="ä¾‹ï¼š1301-000000-0">
            </div>

            <hr class="section-divider">

            <div id="expense_internal" class="conditional">
                <h3 style="margin-bottom:15px; color:#1a5276">äº‹æ¥­å†…è¨“ç·´ã®çµŒè²»</h3>
                <div class="inline-group">
                    <div class="form-group">
                        <label>éƒ¨å¤–è¬›å¸«ã®è¬é‡‘ãƒ»æ‰‹å½“ï¼ˆå††ï¼‰</label>
                        <input type="number" id="instructor_fee" value="0">
                    </div>
                    <div class="form-group">
                        <label>éƒ¨å¤–è¬›å¸«ã®æ—…è²»ï¼ˆå††ï¼‰</label>
                        <input type="number" id="travel_fee" value="0">
                    </div>
                </div>
                <div class="inline-group">
                    <div class="form-group">
                        <label>æ–½è¨­ãƒ»è¨­å‚™ã®å€Ÿä¸Šã’è²»ï¼ˆå††ï¼‰</label>
                        <input type="number" id="facility_fee" value="0">
                    </div>
                    <div class="form-group">
                        <label>æ•™æè²»ãƒ»æ•™ç§‘æ›¸ä»£ï¼ˆå††ï¼‰</label>
                        <input type="number" id="material_fee" value="0">
                    </div>
                </div>
                <div class="form-group">
                    <label>è¨“ç·´ã‚³ãƒ¼ã‚¹ã®é–‹ç™ºè²»ï¼ˆå††ï¼‰</label>
                    <input type="number" id="development_fee" value="0">
                </div>
            </div>

            <div id="expense_external" class="conditional show">
                <h3 style="margin-bottom:15px; color:#1a5276">äº‹æ¥­å¤–è¨“ç·´ã®çµŒè²»</h3>
                <div class="form-group">
                    <label>å…¥å­¦æ–™ãƒ»å—è¬›æ–™ï¼ˆå††ï¼‰<span class="required">*</span>
                        <span class="hint">æ•™è‚²è¨“ç·´æ©Ÿé–¢ã«æ”¯æ‰•ã†è²»ç”¨ã®åˆè¨ˆ</span></label>
                    <input type="number" id="tuition_fee" value="132000">
                </div>
            </div>

            <hr class="section-divider">

            <div class="form-group">
                <label>è³ƒé‡‘åŠ©æˆã®å¯¾è±¡æ™‚é–“æ•°ï¼ˆæ™‚é–“ï¼‰
                    <span class="hint">æ‰€å®šåŠ´åƒæ™‚é–“å†…ã«å®Ÿæ–½ã—ãŸè¨“ç·´ã®åˆè¨ˆæ™‚é–“ã€‚é€šå­¦åˆ¶/åŒæ™‚åŒæ–¹å‘å‹ã®å ´åˆã®ã¿</span></label>
                <input type="number" id="wage_subsidy_hours" value="10">
            </div>
            <div class="form-group" style="max-width:200px">
                <label>åˆ†</label>
                <input type="number" id="wage_subsidy_minutes" value="0" max="59">
            </div>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <button class="btn btn-primary" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- STEP 8: ç¢ºèªãƒ»ç”Ÿæˆ -->
        <div class="step-panel" id="step7">
            <h2>Step 8: ç¢ºèªã¨æ›¸é¡ç”Ÿæˆ</h2>
            <p class="desc">å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã€æ›¸é¡ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„</p>

            <div id="summary" style="background:#f8f9fa; border-radius:8px; padding:20px; margin-bottom:20px;">
                <h3 style="margin-bottom:15px">å…¥åŠ›å†…å®¹ã‚µãƒãƒªãƒ¼</h3>
                <div id="summary_content"></div>
            </div>

            <div class="info-box">
                ã€Œæ›¸é¡ã‚’ç”Ÿæˆã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€å…¥åŠ›å†…å®¹ã«åŸºã¥ã„ã¦å…¨ã¦ã®ç”³è«‹æ›¸é¡ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚<br>
                ç”Ÿæˆã•ã‚Œã‚‹æ›¸é¡ã¯å…ƒã®Excelãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨åŒã˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚
            </div>

            <div id="generate_section" style="text-align:center; margin:30px 0;">
                <button class="btn btn-success" onclick="generateDocuments()">æ›¸é¡ã‚’ç”Ÿæˆã™ã‚‹</button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>æ›¸é¡ã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™...</p>
            </div>

            <div class="result-panel" id="result" style="display:none">
                <div class="icon">&#9989;</div>
                <h2>æ›¸é¡ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼</h2>
                <p id="result_message"></p>
                <div class="file-list" id="file_list"></div>
                <button class="btn btn-success" onclick="downloadFiles()">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆZIPï¼‰</button>
            </div>

            <div class="btn-row">
                <button class="btn btn-secondary" onclick="prevStep()">â† æˆ»ã‚‹</button>
                <div></div>
            </div>
        </div>
    </div>

    <script>
    let currentStep = 0;
    const totalSteps = 8;
    let workerCount = 1;

    function goToStep(step) {
        if (step < 0 || step >= totalSteps) return;
        document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
        document.getElementById('step' + step).classList.add('active');

        document.querySelectorAll('.progress-step').forEach((s, i) => {
            s.classList.remove('active');
            if (i < step) s.classList.add('completed');
            else s.classList.remove('completed');
            if (i === step) s.classList.add('active');
        });

        currentStep = step;
        window.scrollTo(0, 0);

        if (step === totalSteps - 1) updateSummary();
    }

    function nextStep() { goToStep(currentStep + 1); }
    function prevStep() { goToStep(currentStep - 1); }

    function addWorker() {
        workerCount++;
        const container = document.getElementById('workers_container');
        const entry = document.createElement('div');
        entry.className = 'worker-entry';
        entry.dataset.index = workerCount;
        const n = workerCount;
        entry.innerHTML = `
            <h4>å—è¬›è€… ${n} <button class="btn-remove" onclick="removeWorker(this)">å‰Šé™¤</button></h4>
            <div class="inline-group">
                <div class="form-group">
                    <label>æ°å</label>
                    <input type="text" id="worker_${n}_name">
                </div>
                <div class="form-group">
                    <label>ãƒ•ãƒªã‚¬ãƒŠ</label>
                    <input type="text" id="worker_${n}_name_kana">
                </div>
            </div>
            <div class="inline-group">
                <div class="form-group">
                    <label>é›‡ç”¨ä¿é™ºè¢«ä¿é™ºè€…ç•ªå·</label>
                    <input type="text" id="worker_${n}_insurance_1" maxlength="4">
                </div>
                <div class="separator">-</div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <input type="text" id="worker_${n}_insurance_2" maxlength="6">
                </div>
                <div class="separator">-</div>
                <div class="form-group" style="max-width:80px">
                    <label>&nbsp;</label>
                    <input type="text" id="worker_${n}_insurance_3" maxlength="1">
                </div>
            </div>
            <div class="form-group">
                <label>é›‡ç”¨å½¢æ…‹</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="worker_${n}_type" id="worker_${n}_regular" value="regular" checked>
                        <label for="worker_${n}_regular">æ­£è¦é›‡ç”¨åŠ´åƒè€…ç­‰</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="worker_${n}_type" id="worker_${n}_contract" value="contract">
                        <label for="worker_${n}_contract">æœ‰æœŸå¥‘ç´„åŠ´åƒè€…ç­‰</label>
                    </div>
                </div>
            </div>`;
        container.appendChild(entry);
    }

    function removeWorker(btn) {
        btn.closest('.worker-entry').remove();
    }

    // æ¡ä»¶åˆ†å²ã®è¡¨ç¤ºåˆ¶å¾¡
    function setupConditionals() {
        // æ³•äºº/å€‹äººäº‹æ¥­ä¸» åˆ‡æ›¿
        document.querySelectorAll('input[name="applicant_type"]').forEach(r => {
            r.addEventListener('change', () => {
                const isCorp = document.getElementById('applicant_corp').checked;
                document.getElementById('corporate_number_group').classList.toggle('show', isCorp);
                if (isCorp) {
                    document.getElementById('company_name_label').textContent = 'äº‹æ¥­ä¸» åç§°ï¼ˆä¼šç¤¾åï¼‰';
                    document.getElementById('company_name').placeholder = 'ä¾‹ï¼šæ ªå¼ä¼šç¤¾â—‹â—‹';
                    document.getElementById('rep_title_label').textContent = 'ä»£è¡¨è€… å½¹è·å';
                    document.getElementById('representative_title').placeholder = 'ä¾‹ï¼šä»£è¡¨å–ç· å½¹';
                } else {
                    document.getElementById('company_name_label').textContent = 'å±‹å·ï¼ˆã‚ã‚Œã°ï¼‰';
                    document.getElementById('company_name').placeholder = 'ä¾‹ï¼šâ—‹â—‹äº‹å‹™æ‰€ï¼ˆãªã‘ã‚Œã°ç©ºæ¬„ã§OKï¼‰';
                    document.getElementById('rep_title_label').textContent = 'è‚©æ›¸ï¼ˆã‚ã‚Œã°ï¼‰';
                    document.getElementById('representative_title').placeholder = 'ä¾‹ï¼šä»£è¡¨ï¼ˆãªã‘ã‚Œã°ç©ºæ¬„ã§OKï¼‰';
                }
            });
        });

        // ä»£ç†äºº
        document.querySelectorAll('input[name="has_agent"]').forEach(r => {
            r.addEventListener('change', () => {
                document.getElementById('agent_section').classList.toggle('show',
                    document.getElementById('has_agent_yes').checked);
            });
        });

        // å®šé¡åˆ¶ã‚µãƒ¼ãƒ“ã‚¹
        document.querySelectorAll('input[name="is_subscription"]').forEach(r => {
            r.addEventListener('change', () => {
                document.getElementById('subscription_section').classList.toggle('show',
                    document.getElementById('sub_yes').checked);
            });
        });

        // è¨“ç·´æ–¹æ³•
        document.querySelectorAll('input[name="training_method"]').forEach(r => {
            r.addEventListener('change', () => {
                const method = document.querySelector('input[name="training_method"]:checked').value;
                document.getElementById('hours_classroom').classList.toggle('show', method === '1' || method === '2');
                document.getElementById('hours_elearning').classList.toggle('show', method === '3' || method === '4');
            });
        });

        // è³‡æ ¼è©¦é¨“
        document.querySelectorAll('input[name="has_exam"]').forEach(r => {
            r.addEventListener('change', () => {
                document.getElementById('exam_section').classList.toggle('show',
                    document.getElementById('exam_yes').checked);
            });
        });

        // åŠ©æˆåŒºåˆ† â†’ äº‹æ¥­å±•é–‹è¨ˆç”»ã®è¡¨ç¤ºåˆ‡æ›¿
        document.querySelectorAll('input[name="subsidy_type"]').forEach(r => {
            r.addEventListener('change', () => {
                const type = document.querySelector('input[name="subsidy_type"]:checked').value;
                document.getElementById('expansion_content_group').style.display = type === '1' ? 'block' : 'none';
                document.getElementById('dx_content_group').style.display = type !== '1' ? 'block' : 'none';
            });
        });

        // OFF-JTç¨®åˆ¥
        document.querySelectorAll('input[name="offjt_type"]').forEach(r => {
            r.addEventListener('change', () => {
                const type = document.querySelector('input[name="offjt_type"]:checked').value;
                document.getElementById('internal_instructor').classList.toggle('show', type === '1' || type === '2');
                document.getElementById('external_training').classList.toggle('show', type === '2' || type === '3');
                document.getElementById('expense_internal').classList.toggle('show', type === '1' || type === '2');
                document.getElementById('expense_external').classList.toggle('show', type === '3');
            });
        });

        // åˆæœŸè¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼šåŒæ™‚åŒæ–¹å‘å‹ãƒ»DXåŒ–ãƒ»äº‹æ¥­å¤–è¨“ç·´ï¼‰
        document.getElementById('hours_classroom').classList.add('show');
        // DXåŒ–ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãªã®ã§äº‹æ¥­å±•é–‹å†…å®¹ã‚’éè¡¨ç¤ºã€DXå†…å®¹ã‚’è¡¨ç¤º
        document.getElementById('expansion_content_group').style.display = 'none';
        document.getElementById('dx_content_group').style.display = 'block';
    }

    function collectData() {
        const data = {};
        // ãƒ†ã‚­ã‚¹ãƒˆãƒ»æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
        const fields = [
            'submit_year', 'submit_month', 'submit_day', 'labor_bureau',
            'postal_code_1', 'postal_code_2', 'company_address', 'company_name',
            'representative_title', 'representative_name', 'corporate_number',
            'agent_postal_1', 'agent_postal_2', 'agent_address', 'agent_name_org',
            'agent_name_person', 'agent_phone_1', 'agent_phone_2', 'agent_phone_3',
            'office_name', 'office_number_1', 'office_number_2', 'office_number_3',
            'office_postal_1', 'office_postal_2', 'office_address',
            'contact_name', 'contact_dept', 'contact_phone_1', 'contact_phone_2',
            'contact_phone_3', 'contact_email', 'total_employees', 'main_business',
            'course_name', 'num_trainees',
            'training_start_year', 'training_start_month', 'training_start_day',
            'training_end_year', 'training_end_month', 'training_end_day',
            'contract_start_year', 'contract_start_month', 'contract_start_day',
            'contract_end_year', 'contract_end_month', 'contract_end_day',
            'total_subscribers',
            'total_hours', 'total_minutes', 'offjt_hours', 'offjt_minutes',
            'standard_hours', 'standard_minutes',
            'exam_name', 'exam_year', 'exam_month', 'exam_day',
            'expansion_year', 'expansion_month', 'expansion_content', 'dx_content',
            'training_location', 'instructor_name', 'instructor_dept',
            'instructor_title', 'instructor_duties',
            'training_org_name', 'training_org_rep', 'training_org_address',
            'training_org_corp_number',
            'plan_receipt_number',
            'instructor_fee', 'travel_fee', 'facility_fee', 'material_fee',
            'development_fee', 'tuition_fee',
            'wage_subsidy_hours', 'wage_subsidy_minutes',
        ];

        fields.forEach(f => {
            const el = document.getElementById(f);
            if (el) data[f] = el.value;
        });

        // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³
        const radios = [
            'applicant_type', 'has_agent', 'agent_type', 'is_sme', 'subsidy_type', 'is_subscription',
            'training_method', 'has_exam', 'auto_renewal', 'offjt_type', 'contract_reason'
        ];
        radios.forEach(r => {
            const el = document.querySelector(`input[name="${r}"]:checked`);
            if (el) data[r] = el.value;
        });

        // åŠ´åƒè€…ãƒ‡ãƒ¼ã‚¿
        document.querySelectorAll('.worker-entry').forEach(entry => {
            const idx = entry.dataset.index;
            ['name', 'name_kana', 'insurance_1', 'insurance_2', 'insurance_3'].forEach(f => {
                const el = document.getElementById(`worker_${idx}_${f}`);
                if (el) data[`worker_${idx}_${f}`] = el.value;
            });
            const typeEl = document.querySelector(`input[name="worker_${idx}_type"]:checked`);
            if (typeEl) data[`worker_${idx}_type`] = typeEl.value;
        });

        return data;
    }

    function updateSummary() {
        const data = collectData();
        const subsTypes = {'1': 'äº‹æ¥­å±•é–‹ã«ä¼´ã„å®Ÿæ–½ã™ã‚‹è¨“ç·´', '2': 'DXåŒ–ã«ä¼´ã„å®Ÿæ–½ã™ã‚‹è¨“ç·´', '3': 'ã‚°ãƒªãƒ¼ãƒ³ãƒ»ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«åŒ–'};
        const methods = {'1': 'é€šå­¦åˆ¶', '2': 'åŒæ™‚åŒæ–¹å‘å‹', '3': 'eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°', '4': 'é€šä¿¡åˆ¶'};
        const offjts = {'1': 'äº‹æ¥­å†…ï¼ˆéƒ¨å†…è¬›å¸«ï¼‰', '2': 'äº‹æ¥­å†…ï¼ˆéƒ¨å¤–è¬›å¸«ï¼‰', '3': 'äº‹æ¥­å¤–è¨“ç·´'};

        let html = `
            <table style="width:100%; border-collapse:collapse;">
                <tr><td style="padding:5px; font-weight:bold; width:180px">äº‹æ¥­ä¸»</td><td>${data.company_name || '-'}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">æ‰€åœ¨åœ°</td><td>ã€’${data.postal_code_1}-${data.postal_code_2} ${data.company_address || ''}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">ä»£è¡¨è€…</td><td>${data.representative_title} ${data.representative_name}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">ç”³è«‹è€…ç¨®åˆ¥</td><td>${data.applicant_type === 'corporate' ? 'æ³•äºº' : 'å€‹äººäº‹æ¥­ä¸»'}</td></tr>
                ${data.applicant_type === 'corporate' ? `<tr><td style="padding:5px; font-weight:bold">æ³•äººç•ªå·</td><td>${data.corporate_number || 'ï¼ˆæœªå…¥åŠ›ï¼‰'}</td></tr>` : ''}
                <tr><td colspan="2" style="padding:8px 0; border-top:1px solid #ddd"></td></tr>
                <tr><td style="padding:5px; font-weight:bold">äº‹æ¥­æ‰€å</td><td>${data.office_name || '-'}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">äº‹æ¥­æ‰€ç•ªå·</td><td>${data.office_number_1}-${data.office_number_2}-${data.office_number_3}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">æ‹…å½“è€…</td><td>${data.contact_name || '-'}</td></tr>
                <tr><td colspan="2" style="padding:8px 0; border-top:1px solid #ddd"></td></tr>
                <tr><td style="padding:5px; font-weight:bold">åŠ©æˆåŒºåˆ†</td><td>${subsTypes[data.subsidy_type] || '-'}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">è¨“ç·´ã‚³ãƒ¼ã‚¹å</td><td>${data.course_name || '-'}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">å—è¬›è€…æ•°</td><td>${data.num_trainees || '-'}å</td></tr>
                <tr><td style="padding:5px; font-weight:bold">è¨“ç·´æœŸé–“</td><td>${data.training_start_year}/${data.training_start_month}/${data.training_start_day} ï½ ${data.training_end_year}/${data.training_end_month}/${data.training_end_day}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">å®Ÿæ–½æ–¹æ³•</td><td>${methods[data.training_method] || '-'}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">OFF-JTç¨®åˆ¥</td><td>${offjts[data.offjt_type] || '-'}</td></tr>
                <tr><td style="padding:5px; font-weight:bold">å®šé¡åˆ¶ã‚µãƒ¼ãƒ“ã‚¹</td><td>${data.is_subscription === 'yes' ? 'ã¯ã„' : 'ã„ã„ãˆ'}</td></tr>
            </table>`;
        document.getElementById('summary_content').innerHTML = html;
    }

    async function generateDocuments() {
        const data = collectData();
        document.getElementById('generate_section').style.display = 'none';
        document.getElementById('loading').style.display = 'block';

        try {
            const response = await fetch('/generate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            document.getElementById('loading').style.display = 'none';

            if (result.success) {
                document.getElementById('result').style.display = 'block';
                document.getElementById('result_message').textContent = result.message;
                const fileList = document.getElementById('file_list');
                fileList.innerHTML = '<ul>' + result.files.map(f => `<li>${f}</li>`).join('') + '</ul>';
            } else {
                alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + (result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'));
                document.getElementById('generate_section').style.display = 'block';
            }
        } catch (e) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('generate_section').style.display = 'block';
            alert('é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + e.message);
        }
    }

    function downloadFiles() {
        window.location.href = '/download';
    }

    // åˆæœŸåŒ–
    setupConditionals();
    </script>
</body>
</html>
